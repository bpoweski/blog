<figure class='code-highlight-figure'><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'>require 'rake'
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>require 'rake/clean'
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'>CLEAN.include(['ebin/*.beam', '*.dump'])
</div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'>SRC = FileList['src/**/*.erl']
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'>BEAM = []
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'>SRC.each do |fn|
</div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'>  BEAM &lt;&lt; dest = File.join('ebin', File.basename(fn).ext('beam'))
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'>  file dest do
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>    sh "erlc -o ebin #&#x7b;fn&#x7d;" 
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>  end
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'>end
</div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>namespace :erlang do
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'>  desc "staring ermail" 
</div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>    task :run => [:compile] do
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>      sh("erl -noshell -pa ebin -s my_mod start")
</div></div><div data-line='19' class='code-highlight-row numbered'><div class='code-highlight-line'>    end
</div></div><div data-line='20' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='21' class='code-highlight-row numbered'><div class='code-highlight-line'>  desc "run tests" 
</div></div><div data-line='22' class='code-highlight-row numbered'><div class='code-highlight-line'>  task :test => BEAM do
</div></div><div data-line='23' class='code-highlight-row numbered'><div class='code-highlight-line'>    sh("erl -noshell -s test_my_mod test -s init stop")
</div></div><div data-line='24' class='code-highlight-row numbered'><div class='code-highlight-line'>  end
</div></div><div data-line='25' class='code-highlight-row numbered'><div class='code-highlight-line'>end
</div></div><div data-line='26' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='27' class='code-highlight-row numbered'><div class='code-highlight-line'>task :default => [:compile]
</div></div><div data-line='28' class='code-highlight-row numbered'><div class='code-highlight-line'>task :start => ['erlang:run']
</div></div><div data-line='29' class='code-highlight-row numbered'><div class='code-highlight-line'>task :compile => BEAM</div></div></pre></div></figure>